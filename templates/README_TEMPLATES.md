# Excelæ¨¡æ¿ç¤ºä¾‹

æœ¬ç›®å½•åŒ…å«å¸¸ç”¨çš„Excelæ¨¡æ¿ç¤ºä¾‹ï¼Œå¯ç›´æ¥ä¸Šä¼ åˆ°æœåŠ¡å™¨ä½¿ç”¨ã€‚

## ğŸ“ æ¨¡æ¿åˆ—è¡¨

### 1. å·¥èµ„æ¡æ¨¡æ¿ (salary_template.xlsx)

**ç”¨é€”**ï¼šæ‰¹é‡ç”Ÿæˆå‘˜å·¥å·¥èµ„æ¡

**æ¨¡æ¿ç»“æ„**ï¼š
```
Aåˆ—              Båˆ—
--------------------------
1  å§“å            [å¾…å¡«å……]
2  å·¥å·            [å¾…å¡«å……]
3  åŸºæœ¬å·¥èµ„        [å¾…å¡«å……]
4  ç»©æ•ˆå¥–é‡‘        [å¾…å¡«å……]
5  åº”å‘å·¥èµ„        =B3+B4
6  ä¸ªäººæ‰€å¾—ç¨      =B5*0.1
7  å®å‘å·¥èµ„        =B5-B6
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
curl -X POST "http://localhost:8080/api/excel/template/fill-and-download" \
  -H "Content-Type: application/json" \
  -d '{
    "templateFileName": "salary_template.xlsx",
    "downloadFileName": "salary_zhangsan.xlsx",
    "sheetName": "Sheet1",
    "cells": [
      {"cellAddress": "B1", "value": "å¼ ä¸‰", "valueType": "STRING"},
      {"cellAddress": "B2", "value": "E001", "valueType": "STRING"},
      {"cellAddress": "B3", "value": 10000, "valueType": "NUMBER"},
      {"cellAddress": "B4", "value": 2000, "valueType": "NUMBER"}
    ]
  }' --output salary_zhangsan.xlsx
```

---

### 2. å‘ç¥¨æ¨¡æ¿ (invoice_template.xlsx)

**ç”¨é€”**ï¼šç”Ÿæˆæ ‡å‡†å‘ç¥¨

**æ¨¡æ¿ç»“æ„**ï¼š
```
Aåˆ—            Båˆ—        Cåˆ—        Dåˆ—
------------------------------------------------
1  å‘ç¥¨ç¼–å·      [å¾…å¡«å……]
2  å¼€ç¥¨æ—¥æœŸ      [å¾…å¡«å……]
3  å®¢æˆ·åç§°      [å¾…å¡«å……]
4
5  é¡¹ç›®          å•ä»·       æ•°é‡       é‡‘é¢
6  [é¡¹ç›®1]       [å•ä»·]     [æ•°é‡]     =B6*C6
7  [é¡¹ç›®2]       [å•ä»·]     [æ•°é‡]     =B7*C7
8
9  åˆè®¡                                =SUM(D6:D7)
10 ç¨é¢(13%)                           =D9*0.13
11 ä»·ç¨åˆè®¡                            =D9+D10
```

---

### 3. é”€å”®æŠ¥è¡¨æ¨¡æ¿ (sales_report_template.xlsx)

**ç”¨é€”**ï¼šç”Ÿæˆæœˆåº¦/å­£åº¦é”€å”®æŠ¥è¡¨

**æ¨¡æ¿ç»“æ„**ï¼š
```
Aåˆ—          Båˆ—        Cåˆ—        Dåˆ—
---------------------------------------------
1  é”€å”®æŠ¥è¡¨
2  æŠ¥è¡¨æœŸé—´    [å¾…å¡«å……]   é”€å”®å‘˜     [å¾…å¡«å……]
3
4  äº§å“ç±»åˆ«    é”€å”®é¢     å æ¯”       ç¯æ¯”
5  äº§å“A       [å¾…å¡«å……]   =B5/B9     [å¾…å¡«å……]
6  äº§å“B       [å¾…å¡«å……]   =B6/B9     [å¾…å¡«å……]
7  äº§å“C       [å¾…å¡«å……]   =B7/B9     [å¾…å¡«å……]
8
9  æ€»è®¡         =SUM(B5:B7)
```

---

### 4. æˆç»©å•æ¨¡æ¿ (transcript_template.xlsx)

**ç”¨é€”**ï¼šæ‰¹é‡ç”Ÿæˆå­¦ç”Ÿæˆç»©å•

**æ¨¡æ¿ç»“æ„**ï¼š
```
åŒ…å«ï¼š
- å­¦æ ¡logoï¼ˆå›¾ç‰‡ï¼‰
- å­¦ç”Ÿä¿¡æ¯ï¼ˆå§“åã€å­¦å·ï¼‰
- æˆç»©è¡¨æ ¼ï¼ˆå„ç§‘æˆç»©ã€æ€»åˆ†ã€å¹³å‡åˆ†ï¼‰
- ç­¾ç« ä½ç½®
```

---

### 5. åˆåŒæ¨¡æ¿ (contract_template.xlsx)

**ç”¨é€”**ï¼šè‡ªåŠ¨ç”Ÿæˆæ ‡å‡†åˆåŒ

**æ¨¡æ¿ç»“æ„**ï¼š
```
åŒ…å«ï¼š
- åˆåŒç¼–å·ã€æ—¥æœŸ
- ç”²ä¹™æ–¹ä¿¡æ¯
- åˆåŒé‡‘é¢åŠä»˜æ¬¾æ–¹å¼ï¼ˆå«å…¬å¼ï¼‰
- æ³•å¾‹æ¡æ¬¾
```

---

## ğŸ¨ åˆ›å»ºè‡ªå·±çš„æ¨¡æ¿

### æ­¥éª¤1ï¼šè®¾è®¡æ¨¡æ¿

åœ¨Excelä¸­è®¾è®¡æ¨¡æ¿ï¼ŒåŒ…æ‹¬ï¼š
1. **æ ‡é¢˜å’Œlogo**ï¼šå›ºå®šå†…å®¹
2. **æ•°æ®åŒºåŸŸ**ï¼šæ ‡è®°éœ€è¦å¡«å……çš„ä½ç½®
3. **å…¬å¼**ï¼šè®¾ç½®è‡ªåŠ¨è®¡ç®—çš„å…¬å¼
4. **æ ¼å¼**ï¼šè®¾ç½®å•å…ƒæ ¼æ ¼å¼ã€æ¡ä»¶æ ¼å¼

### æ­¥éª¤2ï¼šæ ‡è®°å¡«å……ä½ç½®

æœ‰ä¸¤ç§æ–¹å¼æ ‡è®°ï¼š
```
æ–¹å¼1ï¼šä½¿ç”¨å ä½ç¬¦
  å§“å: [å§“å]
  é‡‘é¢: [é‡‘é¢]

æ–¹å¼2ï¼šç•™ç©ºæˆ–ä½¿ç”¨ç¤ºä¾‹æ•°æ®
  å§“å: 
  é‡‘é¢: 0
```

### æ­¥éª¤3ï¼šæµ‹è¯•æ¨¡æ¿

```bash
# 1. ä¸Šä¼ æ¨¡æ¿
curl -X POST "http://localhost:8080/api/excel/upload" \
  -F "file=@my_template.xlsx"

# 2. æµ‹è¯•å¡«å……
curl -X POST "http://localhost:8080/api/excel/template/fill-and-download" \
  -H "Content-Type: application/json" \
  -d '{
    "templateFileName": "my_template.xlsx",
    "sheetName": "Sheet1",
    "cells": [
      {"cellAddress": "B2", "value": "æµ‹è¯•æ•°æ®", "valueType": "STRING"}
    ]
  }' --output test.xlsx
```

---

## ğŸ’¡ æ¨¡æ¿è®¾è®¡æŠ€å·§

### 1. å…¬å¼è®¾è®¡

```excel
âœ… æ¨èï¼šä½¿ç”¨ç›¸å¯¹å¼•ç”¨
  =B5*C5    // å¯ä»¥å¤åˆ¶åˆ°å…¶ä»–è¡Œ

âŒ é¿å…ï¼šè¿‡å¤šçš„ç»å¯¹å¼•ç”¨
  =$B$5*$C$5  // ä¸æ˜“ç»´æŠ¤
```

### 2. æ ¼å¼è®¾ç½®

```
- ä½¿ç”¨æ¡ä»¶æ ¼å¼ï¼šé‡‘é¢>10000æ˜¾ç¤ºçº¢è‰²
- æ•°å­—æ ¼å¼ï¼š#,##0.00ï¼ˆåƒåˆ†ä½ï¼‰
- æ—¥æœŸæ ¼å¼ï¼šyyyy-mm-dd
- ç™¾åˆ†æ¯”ï¼š0.00%
```

### 3. æ•°æ®éªŒè¯

```
- ä¸‹æ‹‰åˆ—è¡¨ï¼šéƒ¨é—¨é€‰æ‹©
- æ•°å­—èŒƒå›´ï¼š0-100
- æ—¥æœŸèŒƒå›´ï¼š2024å¹´åº¦
```

### 4. ä¿æŠ¤å·¥ä½œè¡¨

```
é”å®šï¼š
  - æ ‡é¢˜è¡Œ
  - å…¬å¼å•å…ƒæ ¼
  - Logoå’Œå›¾ç‰‡

ä¸é”å®šï¼š
  - æ•°æ®è¾“å…¥åŒºåŸŸ
```

---

## ğŸ“¦ æ‰¹é‡ç”Ÿæˆç¤ºä¾‹

### Pythonè„šæœ¬

```python
import requests
import pandas as pd

# ä»CSVè¯»å–æ•°æ®
data = pd.read_csv('data.csv')

# æ‰¹é‡ç”Ÿæˆ
for index, row in data.iterrows():
    payload = {
        'templateFileName': 'template.xlsx',
        'downloadFileName': f'output_{row["id"]}.xlsx',
        'sheetName': 'Sheet1',
        'cells': [
            {'cellAddress': 'B1', 'value': row['name'], 'valueType': 'STRING'},
            {'cellAddress': 'B2', 'value': row['amount'], 'valueType': 'NUMBER'}
        ]
    }
    
    response = requests.post(
        'http://localhost:8080/api/excel/template/fill-and-download',
        json=payload
    )
    
    with open(f'output/file_{row["id"]}.xlsx', 'wb') as f:
        f.write(response.content)
    
    print(f'âœ… {row["name"]} å®Œæˆ')
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ¨¡æ¿åŠŸèƒ½å®Œæ•´æŒ‡å—](../TEMPLATE_GUIDE.md)
- [APIä½¿ç”¨ç¤ºä¾‹](../API_EXAMPLES.md)
- [å¿«é€Ÿå¼€å§‹](../QUICK_START.md)

---

**å¼€å§‹åˆ›å»ºæ‚¨çš„Excelæ¨¡æ¿å§ï¼** ğŸš€

